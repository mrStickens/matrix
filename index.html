<!DOCTYPE html>
<html lang="ru">
<!-- Предыдущий HEAD остается без изменений -->
<head>
    <!-- Предыдущий код head остается тем же -->
    <style>
        /* Предыдущие стили остаются */
        
        .interpretation-block {
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            background: rgba(36, 129, 204, 0.05);
        }

        .interpretation-title {
            font-weight: bold;
            color: var(--tg-theme-link-color);
            margin-bottom: 10px;
        }

        .interpretation-content {
            margin: 10px 0;
        }

        .energy-combination {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid var(--tg-theme-link-color);
        }

        .key-number {
            font-weight: bold;
            color: var(--tg-theme-button-color);
        }

        .matrix-diagonal {
            margin: 10px 0;
            padding: 10px;
            background: rgba(36, 129, 204, 0.08);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <!-- Предыдущий код body до script остается тем же -->

    <script>
        // Предыдущий код JavaScript остается, добавляем новые методы в класс DestinyMatrix

        class DestinyMatrix {
            // Предыдущие методы остаются...

            getMatrixInterpretation(matrix) {
                const interpretations = [];
                
                // Характер (первая строка)
                const characterSum = matrix[0].reduce((a, b) => a + b, 0);
                interpretations.push({
                    title: "Характер и личность",
                    content: this.getCharacterInterpretation(characterSum, matrix[0])
                });

                // Энергия и здоровье (вторая строка)
                const energySum = matrix[1].reduce((a, b) => a + b, 0);
                interpretations.push({
                    title: "Энергетика и здоровье",
                    content: this.getEnergyInterpretation(energySum, matrix[1])
                });

                // Интерес и таланты (третья строка)
                const talentSum = matrix[2].reduce((a, b) => a + b, 0);
                interpretations.push({
                    title: "Таланты и самореализация",
                    content: this.getTalentInterpretation(talentSum, matrix[2])
                });

                return interpretations;
            }

            getCharacterInterpretation(sum, numbers) {
                const interpretations = {
                    low: "Сдержанный характер. Склонность к самоанализу. Необходимо развивать уверенность и самовыражение.",
                    medium: "Сбалансированный характер. Способность адаптироваться к ситуациям. Хорошие коммуникативные навыки.",
                    high: "Сильный, яркий характер. Природные лидерские качества. Важно учиться слушать других."
                };

                let level = sum <= 3 ? "low" : sum <= 6 ? "medium" : "high";
                let specific = "";

                if (numbers[0] > 2) specific += "Повышенное стремление к независимости. ";
                if (numbers[1] > 2) specific += "Развитая интуиция в общении. ";
                if (numbers[2] > 2) specific += "Склонность к творческому самовыражению. ";

                return interpretations[level] + " " + specific;
            }

            getEnergyInterpretation(sum, numbers) {
                const interpretations = {
                    low: "Необходимо уделять внимание накоплению и сохранению энергии. Важен регулярный отдых.",
                    medium: "Стабильный энергетический потенциал. Способность восстанавливаться после нагрузок.",
                    high: "Высокий энергетический потенциал. Склонность к активной деятельности."
                };

                let level = sum <= 3 ? "low" : sum <= 6 ? "medium" : "high";
                let specific = "";

                if (numbers[0] > 2) specific += "Физическая выносливость выше среднего. ";
                if (numbers[1] > 2) specific += "Эмоциональная устойчивость. ";
                if (numbers[2] > 2) specific += "Способность к быстрому восстановлению. ";

                return interpretations[level] + " " + specific;
            }

            getTalentInterpretation(sum, numbers) {
                const interpretations = {
                    low: "Склонность к глубокой специализации. Важно развивать выбранные направления.",
                    medium: "Разносторонние способности. Хороший баланс между разными сферами интересов.",
                    high: "Многогранность талантов. Способность успешно развиваться в нескольких направлениях."
                };

                let level = sum <= 3 ? "low" : sum <= 6 ? "medium" : "high";
                let specific = "";

                if (numbers[0] > 2) specific += "Предрасположенность к точным наукам. ";
                if (numbers[1] > 2) specific += "Творческий потенциал. ";
                if (numbers[2] > 2) specific += "Организаторские способности. ";

                return interpretations[level] + " " + specific;
            }

            getEnergyDescription(energy, value) {
                const descriptions = {
                    E1: {
                        title: "Энергия жизненного пути",
                        interpretations: {
                            low: "Склонность к осторожности и тщательному планированию. Необходимо развивать инициативность.",
                            medium: "Способность находить баланс между риском и осторожностью. Хорошие организаторские способности.",
                            high: "Сильная жизненная позиция, природные лидерские качества. Важно учитывать мнение окружающих."
                        }
                    },
                    E2: {
                        title: "Энергия отношений",
                        interpretations: {
                            low: "Избирательность в общении, глубокие отношения с небольшим кругом людей.",
                            medium: "Способность поддерживать гармоничные отношения, развитая эмпатия.",
                            high: "Харизма, умение влиять на людей, развитые социальные навыки."
                        }
                    },
                    E3: {
                        title: "Энергия самореализации",
                        interpretations: {
                            low: "Фокус на конкретных целях, последовательное развитие.",
                            medium: "Баланс между личными и профессиональными интересами.",
                            high: "Многозадачность, способность вести несколько проектов одновременно."
                        }
                    },
                    E4: {
                        title: "Энергия здоровья",
                        interpretations: {
                            low: "Необходимость регулярной заботы о здоровье, внимание к режиму.",
                            medium: "Хороший потенциал здоровья при правильном образе жизни.",
                            high: "Крепкое здоровье, высокая жизненная сила."
                        }
                    },
                    E5: {
                        title: "Энергия интеллекта",
                        interpretations: {
                            low: "Склонность к специализации, глубокое изучение конкретных тем.",
                            medium: "Сбалансированные интеллектуальные способности, практичность мышления.",
                            high: "Быстрое усвоение информации, способность к комплексному анализу."
                        }
                    },
                    E6: {
                        title: "Энергия духовности",
                        interpretations: {
                            low: "Практичный подход к духовному развитию, важность конкретных практик.",
                            medium: "Гармоничное сочетание духовного и материального.",
                            high: "Глубокая духовная восприимчивость, развитая интуиция."
                        }
                    },
                    E7: {
                        title: "Энергия благосостояния",
                        interpretations: {
                            low: "Необходимость планирования финансов, внимание к деталям в работе.",
                            medium: "Стабильный потенциал для создания благосостояния.",
                            high: "Способность привлекать материальные ресурсы, деловая хватка."
                        }
                    },
                    E8: {
                        title: "Энергия кармы",
                        interpretations: {
                            low: "Фокус на проработке конкретных жизненных уроков.",
                            medium: "Сбалансированное кармическое развитие.",
                            high: "Активная кармическая работа, важные жизненные задачи."
                        }
                    }
                };

                const getLevel = (val) => {
                    if (val <= 7) return "low";
                    if (val <= 14) return "medium";
                    return "high";
                };

                const level = getLevel(value);
                return {
                    title: descriptions[energy].title,
                    interpretation: descriptions[energy].interpretations[level],
                    value: value,
                    level: level
                };
            }

            displayResults(matrix, energies) {
                // Предыдущий код отображения матрицы и графика...

                // Добавляем расширенную интерпретацию
                let interpretationHTML = '<h2>Подробный анализ матрицы</h2>';

                // Добавляем интерпретацию матрицы
                const matrixInterpretations = this.getMatrixInterpretation(matrix);
                matrixInterpretations.forEach(interp => {
                    interpretationHTML += `
                        <div class="interpretation-block">
                            <div class="interpretation-title">${interp.title}</div>
                            <div class="interpretation-content">${interp.content}</div>
                        </div>
                    `;
                });

                // Добавляем интерпретацию энергий
                interpretationHTML += '<h2>Анализ энергетических потоков</h2>';
                energies.forEach((value, index) => {
                    const energyInfo = this.getEnergyDescription(`E${index + 1}`, value);
                    interpretationHTML += `
                        <div class="interpretation-block">
                            <div class="interpretation-title">${energyInfo.title} (E${index + 1})</div>
                            <div class="energy-value">Значение: ${value} (${energyInfo.level})</div>
                            <div class="interpretation-content">${energyInfo.interpretation}</div>
                        </div>
                    `;
                });

                // Добавляем анализ комбинаций энергий
                interpretationHTML += `
                    <div class="interpretation-block">
                        <div class="interpretation-title">Ключевые комбинации энергий</div>
                        <div class="energy-combination">
                            <strong>E1 + E4:</strong> ${this.interpretEnergyCombination(energies[0], energies[3], "жизненная сила")}
                        </div>
                        <div class="energy-combination">
                            <strong>E2 + E7:</strong> ${this.interpretEnergyCombination(energies[1], energies[6], "социальная реализация")}
                        </div>
                        <div class="energy-combination">
                            <strong>E3 + E6:</strong> ${this.interpretEnergyCombination(energies[2], energies[5], "творческий потенциал")}
                        </div>
                    </div>
                `;

                this.interpretation.innerHTML = interpretationHTML;
            }

            interpretEnergyCombination(energy1, energy2, aspect) {
                const sum = energy1 + energy2;
                if (sum <= 15) {
                    return `Необходимо уделить внимание развитию ${aspect}. Потенциал есть, требуется активная работа.`;
                } else if (sum <= 30) {
                    return `Хороший баланс в области ${aspect}. Стабильное развитие и реализация.`;
                } else {
                    return `Исключительный потенциал в сфере ${aspect}. Возможность достижения высоких результатов.`;
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new DestinyMatrix();
        });
    </script>
</body>
</html>
